<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<html>

	<head>
		<meta charset="UTF-8">
		<title>高考志愿填报辅助分析系统</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<link rel="stylesheet" href="../static/css/font.css">
		<link rel="stylesheet" href="../static/css/weadmin.css">


		<!--添加css注册功能css部分样式-->
		<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:400,100,300,500">
		<link rel="stylesheet" href="../lib/othersCss/bootstrap.min.css">
		<link rel="stylesheet" href="../lib/othersCss/form-elements.css">
		<link rel="stylesheet" href="../lib/othersCss/style.css">

		<!--添加注册功能部分js脚本-->
		<script src="../lib/othersJs/bootstrap.min.js"></script>
		<script src="../lib/othersJs/jquery.backstretch.min.js"></script>
		<script src="../lib/othersJs/scripts.js"></script>

	</head>

	<body>
		<div class="weadmin-body">
			<blockquote class="layui-elem-quote">欢迎使用高考志愿填报辅助分析系统！</blockquote>
			<div class="layui-fluid" style="overflow: hidden;">
				<div class="layui-row layui-col-space15">
					<div class="layui-col-md8">
						<div class="layui-card">
							<div class="layui-card-header">快捷方式</div>
							<div class="layui-card-body">
								<div class="layui-carousel weadmin-shortcut" lay-filter="shortcut" lay-indicator="inside" lay-arrow="none" style="width: 100%; height: 280px;">
									<div carousel-item="">
										<ul class="layui-row layui-col-space10 layui-this">
											<li class="layui-col-xs3">
												<a href="https://gaokao.chsi.com.cn/zyck/" target="_blank">
													<i class="layui-icon">&#xe705;</i>
													<cite>阳光高考</cite>
													<p><span>权威发布最新高考招生政策,公示高校特殊类型招生学生名单</span></p>
												</a>
											</li>
											<li class="layui-col-xs3">
												<a href="https://gaokao.chsi.com.cn/zsgs/zhangcheng/listVerifedZszc--method-index,lb-1.dhtml" target="_blank">
													<i class="layui-icon">&#xe735;</i>
													<cite>招生简章</cite>
													<p><span>查阅各大高校的招生简章</span></p>
												</a>
											</li>
											<li class="layui-col-xs3">
												<a href="http://www.moe.gov.cn/" target="_blank">
													<i class="layui-icon">&#xe606;</i>
													<cite>教育部网站</cite>
													<p><span>高考信息公开平台，最权威的公告信息</span></p>
												</a>
											</li>
											<li class="layui-col-xs3">
												<a href="https://www.baidu.com/" target="_blank">
													<i class="layui-icon">&#xe6c6;</i>
													<cite>百度</cite>
													<p><span></span></p>
												</a>
											</li>
											

										</ul>
										<ul class="layui-row layui-col-space10">
											<li class="layui-col-xs3">
												<a href="https://github.com/WangEn/WeAdmin" target="_blank">
													<i class="layui-icon">&#xe600;</i>
													<cite>Github下载</cite>
												</a>
											</li>
											
											<li class="layui-col-xs3">
												<a href="https://gitee.com/lovetime/WeAdmin" target="_blank">
													<i class="layui-icon">&#xe62c;</i>
													<cite>码云下载</cite>
												</a>
											</li>
											<li class="layui-col-xs3">
												<a href="javascript:;" target="_blank">
													<i class="layui-icon layui-icon-set"></i>
													<cite>设置</cite>
												</a>
											</li>
											<li class="layui-col-xs3">
												<a href="javascript:;" target="_blank">
													<i class="layui-icon layui-icon-set"></i>
													<cite>设置</cite>
												</a>
											</li>
											
										</ul>

									</div>
									<div class="layui-carousel-ind">
										<ul>
											<li class="layui-this"></li>
											<li></li>
										</ul>
									</div>
									<!--<button class="layui-icon layui-carousel-arrow" lay-type="sub"></button>
									<button class="layui-icon layui-carousel-arrow" lay-type="add"></button>-->
								</div>

							</div>
						</div>
					</div>
					<div class="layui-col-md4">
						<div class="layui-card">
							<div class="layui-card-header">
								作者叨叨
								<i class="layui-icon" style="color: #FF5722;">&#xe756;</i>
							</div>
							<div class="layui-card-body layui-text weadmin-text">
								<p>本系统为广大考生提供填报志愿的辅助性意见，并且提供获取更多关于报考信息的渠道</p>
								<p>特别声明：本系统仅为广大考生提供基本的数据查询，仅供参考，更权威的信息建议挪步至<a href="http://www.moe.gov.cn/" target="_blank">教育部官网</a></p>
								<!--<p>更完善的商业使用，强烈建议移步<a href="http://www.layui.com/admin/" target="_blank">layuiAdmin</a></p>				-->
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="layui-col-lg12 layui-collapse" style="border: none;">
				<div class="layui-col-lg12 layui-col-md12">
						
					
					<!--统计信息展示-->
					<fieldset class="layui-elem-field" style="padding: 5px;">
						<!--WeAdmin公告-->
						<div class="layui-card">
							<div class="layui-card-header layui-elem-quote">系统公告</div>
							<div class="layui-card-body">
								<div class="layui-carousel weadmin-notice" lay-filter="notice" lay-indicator="inside" lay-arrow="none" style="width: 100%; height: 280px;">
									<div carousel-item="">
										<div class="">
											<a href="#" target="_blank" class="layui-bg-red position" >高考志愿填报辅助分析系统</a>
										</div>
										<div class="">
											<a href="#" target="_blank" class="layui-bg-blue position">高考志愿填报辅助分析系统</a>
										</div>
										<div class="">
											<a href="#" target="_blank" class="layui-bg-green position">高考志愿填报辅助分析系统</a>
										</div>

									</div>
									<div class="layui-carousel-ind">
										<ul>
											<li class="layui-this"></li>
											<li></li>
										</ul>
									</div>
									<!--<button class="layui-icon layui-carousel-arrow" lay-type="sub"></button>
									<button class="layui-icon layui-carousel-arrow" lay-type="add"></button>-->
								</div>

							</div>
						</div>
						<!--<legend>信息统计</legend>-->
						<blockquote class="layui-elem-quote font16" id="titleMsg">请完善以下信息</blockquote>
						<div class="" id="inputScore">
							<form role="form" action="" method="post" class="registration-form">
								<div class="form-group">
										<label class="sr-only" for="form-chinese">语文成绩</label>
										<input type="text" name="username" placeholder="语文成绩" class="form-username form-control" id="form-chinese" >

								</div>

								<div class="form-group">
									<label class="sr-only" for="form-math">数学成绩</label>
									<input type="text" name="password" placeholder="数学成绩" class="form-password form-control" id="form-math" >
								</div>

								<div class="form-group">
									<label class="sr-only" for="form-forign">外语成绩</label>
									<input type="text" name="nickname" placeholder="外语成绩" class="form-nickname form-control" id="form-forign">

								</div>

								<div class="form-group">
									<label class="sr-only" for="form-multiple">综合成绩</label>
									<input type="text" name="realname" placeholder="综合成绩" class="form-realname form-control" id="form-multiple">
								</div>

								<div class="form-group">
									<label class="sr-only">是否学生</label>
									文科<input type="radio" value="0" name="artAndScience" class="form-isStudent">&nbsp;&nbsp;&nbsp;
									理科<input type="radio" value="1" name="artAndScience" class="form-isStudent">
								</div>

								<input class="recommend" value="点击获取推荐学校" lay-submit lay-filter="recommend" style="width:100%;" id="recommend" type="submit">
							</form>
						</div>
						<div class="" id="recommendTable">
							<table id="recommendCollage" lay-filter="layui-collage" ></table>
						</div>
					</fieldset>
				</div>

			</div>
			<div style="clear: both;overflow: hidden; margin-top: 10px;">
				<blockquote class="layui-elem-quote">本系统致力于为考生提供尽可能全面的报考信息参考，服务与广大考生
					<!--<a href="http://fly.layui.com/case/2018/" target="_blank">LayUI相关案例</a>-->
				</blockquote>
				<!--<input type="text" th:text="${isStudent}" th:value="${isStudent}">-->
			</div>
		</div>
		<p id="param">父页面传递过来的参数显示</p>
		<p id="isFirst"></p>
		<!--操作按钮-->
		<script type="text/html" id="opBar">
			<a class="layui-btn-normal layui-btn" lay-event="edit">查看学校官网</a>
			<a class="layui-btn-warm layui-btn" lay-event="show">收藏</a>
			<a class="layui-btn-danger layui-btn" lay-event="analysis">分析</a>
		</script>
	</body>
	<script type="text/javascript" src="../lib/layui/layui.js" charset="utf-8"></script>
	<script type="text/javascript">
		var studentFlag = false;
		var firstLoginFlag = false;
		function toParams(isStudent) {
			//document.getElementById("param").innerHTML = isStudent;
			var arr = isStudent.split("|");
            document.getElementById("param").innerHTML = arr[0];
            document.getElementById("isFirst").innerHTML = arr[1];
            studentFlag = arr[0];
            firstLoginFlag = arr[1];
        }

		layui.extend({
			admin: '{/}../static/js/admin',
		});
		layui.use(['jquery', 'element','util', 'admin', 'carousel','form','table','layer'], function() {
			var element = layui.element,
				$ = layui.jquery,
				carousel = layui.carousel,
				util = layui.util,
				layer = layui.layer,
				form = layui.form,
				table = layui.table,
				admin = layui.admin;
			//建造实例
			carousel.render({
				elem: '.weadmin-shortcut'
				,width: '100%' //设置容器宽度				
				,arrow: 'none' //始终显示箭头	
				,trigger: 'hover'
				,autoplay:false
			});

			var token = "";
			
			carousel.render({
				elem: '.weadmin-notice'
				,width: '100%' //设置容器宽度				
				,arrow: 'none' //始终显示箭头	
				,trigger: 'hover'
				,autoplay:true
			});

            //监听toolbar工具栏操作
            table.on('tool(layui-collage)',function (obj) {
                var data  =obj.data;		//获得该行数据
                var layEvent = obj.event;	//获得 lay-event 对应的值（
                var tr = obj.tr;  ////获得当前行 tr 的 DOM 对象（如果有的话）
                if(layEvent === 'edit'){
                    //alert(data.exUniId);
                    window.open(data.exUniWebsite);
                }
                if(layEvent === 'show'){
                    token = localStorage.getItem("token");
                    $.post("http://localhost:8080/collectCollage?token="+token,{exUniCode:data.exUniCode,exUniName:data.exUniName},function (res) {
						if(res.resultCode == "0000"){
						    layer.alert("提示："+res.resultMsg);
						}else {
                            layer.alert("提示："+res.resultMsg);
						}
					})
                  	//调用收藏接口
				}if(layEvent === 'analysis'){
                    //alert(data.exUniCode);
                    WeAdminEdit(data.exUniName+"数据分析",'./member/edit.html',data.exUniCode);
				}
            });
			
			$(function(){
			    //获取两个标志位，如果还没有获得合法的值，就先等一下
                // if(!((studentFlag == "true" || studentFlag == "false") && (firstLoginFlag == "true" || firstLoginFlag == "false"))){
					// sleep(1000);
                // }
				$("#param").hide();
				$("#isFirst").hide();
			    //如果是学生，并且是首次登录，提示完善信息
			    if(studentFlag=="true" && firstLoginFlag == "true"){
					$("#inputScore").show();
					$("#titleMsg").show();
				}else if (studentFlag == "true" && firstLoginFlag == "false"){		//如果是学生，并且不是首次登录，直接调用接口展示即可
                    getRecommendNotFirst();
                    getScorePosition();
                    $("#inputScore").hide();
					$("#titleMsg").hide();
					$("#recommendTable").show();
				}else {
                    $("#inputScore").hide();
                    $("#titleMsg").hide();
				}
				setTimeAgo(2018,0,1,13,14,0,'#firstTime');
				setTimeAgo(2019,5,20,16,0,0,'#lastTime');
			});
			function setTimeAgo(y, M, d, H, m, s,id){
			    var str = util.timeAgo(new Date(y, M||0, d||1, H||0, m||0, s||0));
			    $(id).html(str);
			    console.log(str);
			 };

            function sleep(numberMillis) {
                var now = new Date();
                var exitTime = now.getTime() + numberMillis;
                while (true) {
                    now = new Date();
                    if (now.getTime() > exitTime)
                        return;
                }
            };
            
            function setStatus(data) {
				var status = data.status;
				if(status == "合适"){
				    return "<span style='color:orange'>合适</span>";
				}else if (status == "冲刺"){
				    return "<span style='color:red'>冲刺</span>";
				}else {
                    return "<span style='color:green'>求稳</span>";
				}
            }

            function getScorePosition() {
                token = localStorage.getItem("token");
                $.post("http://localhost:8080/getScorePosition?token="+token,function (res) {
					if(res.code == "0000"){
						$(".position").html("提示：您的分数在全国（位次）排名位于:"+res.data+"名");
					}else {
					    layer.alert("系统异常：分数位次(排名)获取失败！");
					}
				})
            }


			//重新写一个接口，学生用户不是首次登录，直接调用该接口，懒得动原接口了
			function getRecommendNotFirst() {
					token = localStorage.getItem("token");
                    table.render({
                        elem: '#recommendCollage',
                        url: 'http://localhost:8080/recommendCollageNotFirst?token='+token,
                        cols:[[
                            {
                                field:'exUniName',
                                title:'学校名称',
                                sort:true,
                                width:200
                            },
                            {
                                field:'exUniProvince',
                                title:'省份',
                                sort:true,
                                width:100
                            },
                            {
                                field:'exUniCity',
                                title:'城市',
                                sort:true,
                                width:80
                            },
                            {
                                field:'exUniType',
                                title:'学校类型',
                                sort:true,
                                width:100
                            },
                            {
                                field:'exUniLevel',
                                title:'办学层次',
                                sort:true,
                                width:100
                            },
                            {
                                field:'exUniGrade',
                                title:'学校层次',
                                sort:true,
                                width:180
                            },
                            {
                                field:'exUniTel',
                                title:'招生电话',
                                sort:true,
                                width:150
                            },
                            {
                                field:'exUniAddress',
                                title:'学校地址',
                                sort:true,
                                width:300
                            },
                            {
                                field:'status',
                                title:'推荐指数',
                                sort:true,
                                width:80,
								templet:setStatus,
								align:'center'
                            },
                            {
                                title:'操作',
                                fiexd:'right',
                                width:310,
                                align:'center',
                                toolbar:'#opBar'
                            }

                        ]]
                        //,…… //其他参数
                    });
            };


            form.on('submit(recommend)', function(data){
                token = localStorage.getItem("token");

               var chinese = $("#form-chinese").val();
               var math = $("#form-math").val();
               var forign = $("#form-forign").val();
               var multiple = $("#form-multiple").val();
               var artAndScience = $("input[type='radio']:checked").val();

                table.render({
                    elem: '#recommendCollage',
                    url: 'http://localhost:8080/recommendCollage?token='+token,
					where:{chinese:chinese,math:math,forign:forign,multiple:multiple,artAndScience:artAndScience},

                    cols:[[
                        {
                            field:'exUniName',
                            title:'学校名称',
                            sort:true,
                            width:200
                        },
                        {
                            field:'exUniProvince',
                            title:'省份',
                            sort:true,
                            width:100
                        },
                        {
                            field:'exUniCity',
                            title:'城市',
                            sort:true,
                            width:80
                        },
                        {
                            field:'exUniType',
                            title:'学校类型',
                            sort:true,
                            width:100
                        },
                        {
                            field:'exUniLevel',
                            title:'办学层次',
                            sort:true,
                            width:100
                        },
                        {
                            field:'exUniGrade',
                            title:'学校层次',
                            sort:true,
                            width:180
                        },
                        {
                            field:'exUniTel',
                            title:'招生电话',
                            sort:true,
                            width:150
                        },
                        {
                            field:'exUniAddress',
                            title:'学校地址',
                            sort:true,
                            width:300
                        },
                        {
                            field:'status',
                            title:'推荐指数',
                            sort:true,
                            width:100,
                            templet:setStatus,
                            align:'center'
                        },
                        {
                            title:'操作',
                            fiexd:'right',
                            width:310,
                            align:'center',
                            toolbar:'#opBar'
                        }

                    ]]
                    //,…… //其他参数
                });
                getScorePosition();
                return false;
            });



		});
	</script>

</html>